/**
 * A reusable helper to convert country names to their corresponding COW codes.
 */
export const COUNTRY_CODE_MAP = {
  "Afghanistan": 700,
  "Albania": 339,
  "Algeria": 615,
  "America": 2,
  "Andorra": 232,
  "Angola": 540,
  "Antigua & Barbuda": 58,
  "Arab Republic of Egypt": 651,
  "Argentina": 160,
  "Armenia": 371,
  "Australia": 900,
  "Austria": 305,
  "Austria-Hungary": 300,
  "Azerbaijan": 373,
  "Baden": 267,
  "Bahamas": 31,
  "Bahrain": 692,
  "Bangladesh": 771,
  "Barbados": 53,
  "Bavaria": 245,
  "Belarus": 370,
  "Belgium": 211,
  "Belize": 80,
  "Benin": 434,
  "Bhutan": 760,
  "Bolivarian Republic of Venezuela": 101,
  "Bolivia": 145,
  "Bolivia (Plurinational State of)": 145,
  "Bosnia and Herzegovina": 346,
  "Botswana": 571,
  "Brazil": 140,
  "Britain": 200,
  "Brunei": 835,
  "Bulgaria": 355,
  "Burkina Faso": 439,
  "Burundi": 516,
  "Cabo Verde": 402,
  "Cambodia": 811,
  "Cameroon": 471,
  "Canada": 20,
  "Cape Verde": 402,
  "Central African Republic": 482,
  "Chad": 483,
  "Chile": 155,
  "China": 710,
  "Colombia": 100,
  "Comoros": 581,
  "Congo": 484,
  "Congo (Brazzaville)": 484,
  "Congo (Kinshasa)": 490,
  "Costa Rica": 94,
  "Croatia": 344,
  "Cuba": 40,
  "Cyprus": 352,
  "Czech Republic": 316,
  "Czechoslovakia": 315,
  "Democratic People's Republic of Korea": 731,
  "Democratic Republic of the Congo": 490,
  "Denmark": 390,
  "Djibouti": 522,
  "Dominica": 54,
  "Dominican Republic": 42,
  "East Timor": 860,
  "Ecuador": 130,
  "Egypt": 651,
  "El Salvador": 92,
  "England": 200,
  "Equatorial Guinea": 411,
  "Eritrea": 531,
  "Estonia": 366,
  "Ethiopia": 530,
  "Federated States of Micronesia": 987,
  "Fiji": 950,
  "Finland": 375,
  "France": 220,
  "Gabon": 481,
  "Gambia": 420,
  "Georgia": 372,
  "German Democratic Republic": 265,
  "German Federal Republic": 260,
  "Germany": 255,
  "Ghana": 452,
  "Great Britain": 200,
  "Greece": 350,
  "Grenada": 55,
  "Guatemala": 90,
  "Guinea": 438,
  "Guinea-Bissau": 404,
  "Guyana": 110,
  "Haiti": 41,
  "Hanover": 240,
  "Hesse Electoral": 273,
  "Hesse Grand Ducal": 275,
  "Honduras": 91,
  "Hungary": 310,
  "Iceland": 395,
  "India": 750,
  "Indonesia": 850,
  "Iran": 630,
  "Iraq": 645,
  "Ireland": 205,
  "Islamic Republic of Iran": 630,
  "Israel": 666,
  "Italy": 325,
  "Ivory Coast": 437,
  "Jamaica": 51,
  "Japan": 740,
  "Jordan": 663,
  "Kazakhstan": 705,
  "Kenya": 501,
  "Kiribati": 946,
  "Korea": 730,
  "Korea (North)": 731,
  "Korea (South)": 732,
  "Kosovo": 347,
  "Kuwait": 690,
  "Kyrgyzstan": 703,
  "Lao People's Democratic Republic": 812,
  "Laos": 812,
  "Latvia": 367,
  "Lebanon": 660,
  "Lesotho": 570,
  "Liberia": 450,
  "Libya": 620,
  "Libyan Arab Jamahiriya": 620,
  "Liechtenstein": 223,
  "Lithuania": 368,
  "Luxembourg": 212,
  "Macedonia": 343,
  "Madagascar": 580,
  "Malawi": 553,
  "Malaysia": 820,
  "Maldives": 781,
  "Mali": 432,
  "Malta": 338,
  "Marshall Islands": 983,
  "Mauritania": 435,
  "Mauritius": 590,
  "Mecklenburg Schwerin": 280,
  "Mexico": 70,
  "Modena": 332,
  "Moldova": 359,
  "Monaco": 221,
  "Mongolia": 712,
  "Montenegro": 341,
  "Morocco": 600,
  "Mozambique": 541,
  "Myanmar": 775,
  "Namibia": 565,
  "Nauru": 970,
  "Nepal": 790,
  "Netherlands": 210,
  "New Zealand": 920,
  "Nicaragua": 93,
  "Niger": 436,
  "Nigeria": 475,
  "North Korea": 731,
  "Norway": 385,
  "Oman": 698,
  "Ottoman Empire": 640,
  "Pakistan": 770,
  "Palau": 986,
  "Panama": 95,
  "Papal States": 327,
  "Papua New Guinea": 910,
  "Paraguay": 150,
  "Parma": 335,
  "People's Republic of China": 710,
  "Persia": 630,
  "Peru": 135,
  "Philippines": 840,
  "Poland": 290,
  "Portugal": 235,
  "PRC": 710,
  "Qatar": 694,
  "Republic of Korea": 732,
  "Republic of Moldova": 359,
  "Republic of the Congo": 484,
  "Republic of Turkey": 640,
  "Republic of Vietnam": 817,
  "Romania": 360,
  "Russia": 365,
  "Russian Federation": 365,
  "Rwanda": 517,
  "Samoa": 990,
  "San Marino": 331,
  "Sao Tome and Principe": 403,
  "SAR": 652,
  "Saudi Arabia": 670,
  "Saxony": 269,
  "Senegal": 433,
  "Seychelles": 591,
  "Sierra Leone": 451,
  "Singapore": 830,
  "Slovakia": 317,
  "Slovenia": 349,
  "Socialist Republic of Vietnam": 816,
  "Solomon Islands": 940,
  "Somalia": 520,
  "South Africa": 560,
  "South Korea": 732,
  "South Sudan": 626,
  "Soviet Union": 365,
  "Spain": 230,
  "Sri Lanka": 780,
  "St. Kitts and Nevis": 60,
  "St. Lucia": 56,
  "St. Vincent and the Grenadines": 57,
  "Sudan": 625,
  "Suriname": 115,
  "Swaziland": 572,
  "Sweden": 380,
  "Switzerland": 225,
  "Syria": 652,
  "Syrian Arab Republic": 652,
  "Taiwan": 713,
  "Tajikistan": 702,
  "Tanzania": 510,
  "Thailand": 800,
  "Togo": 461,
  "Tonga": 955,
  "Trinidad and Tobago": 52,
  "Tunisia": 616,
  "Turkey": 640,
  "Turkiye": 640,
  "Turkmenistan": 701,
  "Tuscany": 337,
  "Tuvalu": 947,
  "Two Sicilies": 329,
  "U.S.": 2,
  "Uganda": 500,
  "UK": 200,
  "Ukraine": 369,
  "United Arab Emirates": 696,
  "United Kingdom": 200,
  "United Republic of Tanzania": 510,
  "United States": 2,
  "United States of America": 2,
  "Uruguay": 165,
  "US": 2,
  "USA": 2,
  "USSR": 365,
  "Uzbekistan": 704,
  "Vanuatu": 935,
  "Venezuela": 101,
  "Viet Nam": 816,
  "Vietnam": 816,
  "Wuerttemburg": 271,
  "Yemen": 679,
  "Yemen Arab Republic": 678,
  "Yemen People's Republic": 680,
  "Yugoslavia": 345,
  "Zaire": 490,
  "Zambia": 551,
  "Zanzibar": 511,
  "Zimbabwe": 552,
};

/**
 * Get a COW country code from a given country name (case-insensitive)
 * @param {string} name - The country name
 * @returns {number|null} - The COW code, or null if not found
 */
export function getCountryCodeByName(name) {
  if (!name) return null;

  const normalized = name.trim().toLowerCase();
  const entry = Object.entries(COUNTRY_CODE_MAP).find(
    ([country]) => country.toLowerCase() === normalized
  );

  return entry ? entry[1] : null;
}

const CODE_TO_COUNTRY_MAP = {};
Object.entries(COUNTRY_CODE_MAP).forEach(([name, code]) => {
  // Prefered names
  if (!CODE_TO_COUNTRY_MAP[code] || name.length < CODE_TO_COUNTRY_MAP[code].length) {
    // Special cases for preferred names
    if (code === 2 && name === "United States") {
      CODE_TO_COUNTRY_MAP[code] = "US";
    } else if (code === 200 && name === "United Kingdom") {
      CODE_TO_COUNTRY_MAP[code] = "UK";
    } else if (code === 365 && name === "Russia") {
      CODE_TO_COUNTRY_MAP[code] = "Russia";
    } else if (code === 710 && name === "China") {
      CODE_TO_COUNTRY_MAP[code] = "China";
    } else if (code === 640 && name === "Turkey") {
      CODE_TO_COUNTRY_MAP[code] = "Turkiye";
    } else if (!CODE_TO_COUNTRY_MAP[code]) {
      CODE_TO_COUNTRY_MAP[code] = name;
    }
  }
});

/**
 * Get a country name from a COW country code
 * @param {number|string} code - The COW country code
 * @returns {string} - The country name, or the code itself if not found
 */
export function getCountryNameByCode(code) {
  if (!code) return 'Unknown';
  
  const numericCode = typeof code === 'string' ? parseInt(code) : code;
  return CODE_TO_COUNTRY_MAP[numericCode] || `Code ${code}`;
}
